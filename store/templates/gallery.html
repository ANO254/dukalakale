{% extends "base.html" %}
{% block content %}

<div class="max-w-6xl mx-auto p-4">
    <h1 class="text-4xl font-bold mb-8 text-center">Gallery</h1>

    <!-- Instagram-style responsive grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-2">
        {% for image in images %}
        <div class="relative w-full aspect-square overflow-hidden cursor-pointer group"
             @click="openModal({{ forloop.counter0 }})">
            <img src="{{ image.image.url }}" 
                 alt="{{ image.title }}" 
                 class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
            <div class="absolute bottom-2 left-2 bg-black bg-opacity-50 text-white px-2 py-1 text-sm rounded">
                {{ image.title }}
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Modal Lightbox -->
<div x-data="gallery()" x-show="isOpen" x-cloak
     class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50">

    <!-- Close Button -->
    <button @click="closeModal()"
            class="absolute top-4 right-4 text-white text-3xl font-bold hover:text-red-500 transition">&times;</button>

    <!-- Previous Button -->
    <button @click="prev()" 
            class="absolute left-4 text-white text-4xl font-bold hover:text-gray-300 transition">&larr;</button>

    <!-- Next Button -->
    <button @click="next()" 
            class="absolute right-4 text-white text-4xl font-bold hover:text-gray-300 transition">&rarr;</button>

    <!-- Image container -->
    <div class="max-w-[90vw] max-h-[90vh] flex items-center justify-center">
        <img :src="images[currentIndex]" 
             class="object-contain max-h-full max-w-full rounded shadow-lg">
    </div>
</div>

<!-- Alpine.js for lightbox -->
<script>
function gallery() {
    return {
        images: [
            {% for image in images %}
            '{{ image.image.url }}',
            {% endfor %}
        ],
        isOpen: false,
        currentIndex: 0,
        openModal(index) {
            this.currentIndex = index;
            this.isOpen = true;
        },
        closeModal() {
            this.isOpen = false;
        },
        prev() {
            this.currentIndex = (this.currentIndex === 0) ? this.images.length - 1 : this.currentIndex - 1;
        },
        next() {
            this.currentIndex = (this.currentIndex === this.images.length - 1) ? 0 : this.currentIndex + 1;
        }
    }
}
</script>

{% endblock %}
