{% extends "base.html" %} {% block content %}

<!-- Hero Section -->
<section
  class="bg-dark text-white py-5 mb-5"
  style="background: linear-gradient(45deg, #1f2937, #4b5563)"
>
  <div class="container text-center">
    <h1 class="display-4 fw-bold animate__animated animate__fadeInDown">
      Duka La Kale
           
    </h1>
    <p class="lead animate__animated animate__fadeInUp animate__delay-1s">
      where every piece tells a story.
    </p>
    <p class="lead animate__animated animate__fadeInUp animate__delay-2s">
        Explore our curated collection of unique, handcrafted products
        designed to inspire and delight.
    </p>

    <a
      href="{% url 'shop' %}"
      class="btn btn-light btn-lg mt-3 animate__animated animate__fadeInUp animate__delay-3s"
    >
      Browse All Products
    </a>
  </div>
</section>

<!-- Featured Products Grid -->
<section class="container">
  <h2 class="mb-4 fw-bold text-center">Featured Products</h2>
  <div class="row g-4">
    {% for product in products %}
    <div class="col-12 col-sm-6 col-md-4 col-lg-3">
      <div
        class="card h-100 shadow-sm border-0 product-card"
        style="transition: transform 0.3s"
      >
        <!-- Product Image -->
        <img
          src="{{ product.image.url }}"
          class="card-img-top"
          alt="{{ product.name }}"
          style="height: 220px; object-fit: cover; transition: transform 0.3s"
        />

        <div class="card-body d-flex flex-column">
          <h5 class="card-title fw-semibold">{{ product.name }}</h5>
          <p class="card-text text-muted mb-2">KES {{ product.price }}</p>

          <!-- Add to Cart Button -->
          <a
            href="{% url 'add_to_cart' product.id %}"
            class="btn btn-dark mt-auto w-100 add-to-cart-btn"
            data-product-id="{{ product.id }}"
          >
            ðŸ›’ Add to Cart
          </a>
        </div>
      </div>
    </div>
    {% empty %}
    <p class="text-center text-muted">No products available.</p>
    {% endfor %}
  </div>
</section>

<!-- Newsletter Subscription Section -->
<section class="bg-dark text-white py-5 my-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-6">
        <div class="text-center mb-4">
            <h2 class="fw-bold mb-2">Stay Updated!</h2>
          <p class="lead text-light">Subscribe to our newsletter for exclusive offers and new product launches</p>
        </div>

        <!-- Subscription Form -->
        <form id="subscribeForm" class="mt-4">
          {% csrf_token %}
          
          <div class="input-group input-group-lg">
            <input
              type="email"
              id="subscribeEmail"
              name="email"
              class="form-control rounded-start"
              placeholder="Enter your email address"
              required
              pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
              title="Please enter a valid email address"
            />
            <button
              class="btn btn-primary rounded-end"
              type="submit"
              style="background: #b19338; border: none; font-weight: 600;"
            >
              Subscribe
            </button>
          </div>

          <!-- Message Alert -->
          <div id="subscribeMessage" class="mt-3"></div>
        </form>

        <p class="text-center text-muted mt-3" style="font-size: 0.9rem;">
          We'll never spam you. Unsubscribe at any time.
        </p>
      </div>
    </div>
  </div>
</section>

<!-- Optional Footer / Call-to-Action -->

<!-- Optional CSS for hover effects -->
<style>
  .product-card:hover img {
    transform: scale(1.05);
  }
  .product-card:hover {
    transform: translateY(-5px);
  }
</style>

<!-- Animate.css for subtle animations -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
/>

<script>
  document
    .getElementById("subscribeForm")
    .addEventListener("submit", function (e) {
      e.preventDefault();
      const form = this;
      const messageDiv = document.getElementById("subscribeMessage");
      const submitBtn = form.querySelector('button[type="submit"]');
      const originalText = submitBtn.textContent;

      // Disable button during submission
      submitBtn.disabled = true;
      submitBtn.textContent = "Subscribing...";

      fetch('{% url "subscribe" %}', {
        method: "POST",
        body: new FormData(form),
      })
        .then((r) => r.json())
        .then((data) => {
          messageDiv.className =
            "alert " + (data.success ? "alert-success" : "alert-danger");
          messageDiv.textContent = data.message;
          if (data.success) {
            document.getElementById("subscribeEmail").value = "";
            // Auto-hide success message after 5 seconds
            setTimeout(() => {
              messageDiv.textContent = "";
            }, 5000);
          }
        })
        .catch((error) => {
          messageDiv.className = "alert alert-danger";
          messageDiv.textContent = "An error occurred. Please try again.";
        })
        .finally(() => {
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        });
    });
</script>

{% endblock %}
